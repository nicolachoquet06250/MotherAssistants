<!DOCTYPE html>
<html style="overflow: hidden;">
<head>
	<meta charset="utf-8"/>
	@html.block('page_title', function(model) {
		<title>@model.title</title>
	})

	<link rel="icon" href="/images/favicon.ico" />
	<link rel="manifest" href="/manifest.json" />
	<meta name="mobile-web-app-capable" content="yes"/>
	<meta name="apple-mobile-web-app-capable" content="yes"/>
	<meta name="application-name" content="MotherAssistants"/>
	<meta name="apple-mobile-web-app-title" content="MotherAssistants"/>
	<meta name="msapplication-starturl" content="/"/>
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, shrink-to-fit=no"/>

	<link rel="stylesheet" href="/node_modules/materialize-social/materialize-social.css">
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons"
	      rel="stylesheet">

	<link rel="stylesheet"
	      href="/stylesheets/materializecss/materialize.min.css"
	      media="screen,projection">

	<link rel='stylesheet'
	      href='/stylesheets/style.css' />
	@html.block('additional_css')
</head>
<body>
	<div class="loader red">
		@html.block('loader', function(model) {
			@html.include('includes/loader')
		})
	</div>
	<header>
		@html.block('menu', function(model) {
			@html.include('includes/menus/top_menu')
		})
	</header>
	<main>
		@html.block('content')
		<div class="modal-container">
			<div id="messages" class="modal bottom-sheet messages">
				<div class="container">
					<div class="row">
						<div class="col s12" style="margin-top: 10px;">
							<h4><i class="material-icons">messages</i> Messages</h4>
						</div>
					</div>
					<div class="row">
						<div class="col s12">
							<div class="message me">

							</div>
							<div class="message me last">

							</div>
						</div>
						<div class="col s12">
							<div class="message you last">

							</div>
						</div>
					</div>
					<div class="row">
						<div class="input-field col s12">
							<textarea id="textarea1" class="materialize-textarea"></textarea>
							<label for="textarea1">Textarea</label>
						</div>
					</div>
				</div>
			</div>
			<div id="photos_in_messages" class="modal modal-fixed-footer">
				<div class="container">
					<div class="row" style="margin-top: 20px;"></div>
					<div class="row">
						<div class="col s12">
							<h4><i class="material-icons">mms</i> Médias</h4>
						</div>
					</div>
					<div class="row">
						<div class="col s12 center-align">
						<span>
							Aucun média n'a été transmis dans cette conversation.
						</span>
						</div>
					</div>
				</div>
			</div>
			@html.block('modals')
		</div>
	</main>
	@html.block('footer', function(model) {
		@html.include('includes/footer')
	})
	<script src="/javascripts/main_domain.js"></script>
	<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
	<script src="/javascripts/materializecss/materialize.min.js"></script>
<!--	<script src="https://cdn.socket.io/socket.io-1.5.1.js"></script>-->
	<script src="/socket.io-client/socket.io.js"></script>
	<script src="/javascripts/script.js"></script>
	<script>
		window.onload = () => {
			let domain = main_domain();
			let connection_string = `ws${domain !== 'localhost' ? 's' : ''}://${domain}${domain === 'localhost' ? ':3000' : ''}`;
			// io.set('transports', ['websocket']);
			window.WebSocket = window.WebSocket || window.WebSocketServer;
			let socket = new window.WebSocket(connection_string);
			socket.onopen = e => {
				console.log(e)
			};
			socket.onerror = err => {
				console.error(err)
			};
		};
		let current_page = '@model.current_page';
		current_page ? setup(current_page) : setup(null);
	</script>
	@html.block('additional_js')
</body>
</html>
